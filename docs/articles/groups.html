<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Constructing SNP Groups â€¢ MFM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Constructing SNP Groups">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MFM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MFM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/groups.html">Constructing SNP Groups</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jennasimit/MFM">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Constructing SNP Groups</h1>
                        <h4 class="author">Jenn Asimit</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:ja628@cam.ac.uk" class="email">ja628@cam.ac.uk</a>
      
                              <h4 class="author">Chris Wallace</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:cew54@cam.ac.uk" class="email">cew54@cam.ac.uk</a>
      
                  
            <h4 class="date">2019-04-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jennasimit/MFM/blob/master/vignettes/groups.Rmd"><code>vignettes/groups.Rmd</code></a></small>
      <div class="hidden name"><code>groups.Rmd</code></div>

    </div>

    
    
<div id="snp-groups-based-on-multiple-diseases" class="section level1">
<h1 class="hasAnchor">
<a href="#snp-groups-based-on-multiple-diseases" class="anchor"></a>SNP Groups based on multiple diseases</h1>
<p>In the interpretation of MFM results, rather than reporting posterior probabilities for each SNP model, we focus on SNP groups that we construct such that SNPs in the same group are in LD, have a similar effect on disease, and rarely appear together in a disease model. SNP groups and their construction for one disease are detailed in the <a href="https://rawgit.com/chr1swallace/GUESSFM/master/inst/doc/groups.html">GUESSFM Tags/Groups vignette</a>.</p>
<p>SNPs with marginal posterior probability of inclusion &gt; 0.001 were placed in groups such that those in the same group could be substituted for one another in a model. Following from this, criteria for SNPs to be in the same group are:</p>
<ol style="list-style-type: decimal">
<li><p>SNPs are in LD (pairwise <span class="math inline">\(r^2 &gt; 0.05\)</span>, pairwise <span class="math inline">\(r&lt;0\)</span>.</p></li>
<li><p>SNPs are rarely selected together in models; marginal posterior probability that both are included in a model was <span class="math inline">\(&lt; 0.01\)</span>.</p></li>
</ol>
<p>We hierarchically cluster SNPs within each disease according to <span class="math inline">\(r^2 x sign(r)\)</span> using complete linkage, and group SNPs by cutting the tree according to the above two criteria. We then identify overlapping groups defined in different diseases, and merge or split groups when they meet this criteria. This algorithm is implemented in the <a href="https://github.com/chr1swallace/GUESSFM/blob/master/R/groups.R">group.multi</a> function in GUESSFM.</p>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Continuing with the data that was simulated in the MFM <a href="https://jennasimit.github.io/MFM/articles/MFM.html">Introduction</a> vignette, the group.multi function requires the list of GUESSFM output (SM2) and the SnpMatrix to calculate <span class="math inline">\(r^2\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(MFM) <span class="co"># contains objects Gm, SM2</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; Warning: replacing previous import 'data.table::melt' by 'reshape::melt'</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; when loading 'GUESSFM'</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(GUESSFM) <span class="co"># contains function group.multi</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co"># Gm is the SnpMatrix for controls and both diseases. For LD calculations we use only the controls, </span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># identifed as c0 below, Gm[c0,] </span></a>
<a class="sourceLine" id="cb1-7" title="7">Gm</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; A SnpMatrix with  9000 rows and  26 columns</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; Row names:  control.1 ... case2.3000 </span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; Col names:  rs12722563 ... rs41295159</span></a>
<a class="sourceLine" id="cb1-11" title="11">c0 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">grep</a></span>(<span class="st">"control."</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(Gm)) <span class="co"># identify controls in Gm SnpMatrix</span></a>
<a class="sourceLine" id="cb1-12" title="12">info &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/GUESSFM/topics/group.multi">group.multi</a></span>(SM2,Gm[c0,]) </a>
<a class="sourceLine" id="cb1-13" title="13">Sgroups &lt;-<span class="st"> </span>info<span class="op">$</span>groups<span class="op">@</span>.Data</a></code></pre></div>
<p>The info object is a list with three objects:</p>
<ol style="list-style-type: decimal">
<li><p>summary: a data.frame with each row giving summary statistics for each group</p></li>
<li><p>groups: the constructed SNP groups; a groups object, each element ordered according to the rows of the summary</p></li>
<li><p>r2: the calculated <span class="math inline">\(r^2\)</span> matrix</p></li>
</ol>
<p>The SNP groups are identified as</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">Sgroups</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; [1] "rs11597367" "rs11594656" "rs35285258"</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; [1] "rs56382813" "rs41295105" "rs41295079" "rs62626325" "rs3118475" </span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; [6] "rs62626317" "rs41295055"</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; [1] "rs12722522" "rs7909519"  "rs12722508" "rs41295049" "rs61839660"</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; [6] "rs12722496" "rs12722495"</span></a></code></pre></div>
<p>These 3 groups match or a subset of our previously identified SNP groups for C, D, and A, as given in snpGroups.</p>
<p>#check</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">setdiff</a></span>(snpGroups[[<span class="st">"C"</span>]],Sgroups[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; character(0)</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">setdiff</a></span>(snpGroups[[<span class="st">"D"</span>]],Sgroups[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; character(0)</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">setdiff</a></span>(snpGroups[[<span class="st">"A"</span>]],Sgroups[[<span class="dv">3</span>]])</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; [1] "rs12722563"</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#snp-groups-based-on-multiple-diseases">SNP Groups based on multiple diseases</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example">Example</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jenn Asimit, Chris Wallace.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
